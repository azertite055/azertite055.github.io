<!DOCTYPE html>
<html>
<head>
<title>Text Dash</title>
<style>
body {
  background-color: white;
  font-family: courier;
  text-align: center;
}
p {
  text-align: center;
}
#display {
	line-height: 0;
}
.top {
	border-left: 1px solid black;
	border-right: 1px solid black;
	border-top: 1px solid black;
}
.btwn {
	border-left: 1px solid black;
	border-right: 1px solid black;
}
.bottom {
	border-left: 1px solid black;
	border-right: 1px solid black;
	border-bottom: 1px solid black;
}
</style>
</head>
<body>
<p>-=- Text Dash! -=-<br>Press any key to jump, select level by clicking below<br><br>
<span onclick="goToLevel(1)">Level 1</span> | <span onclick="goToLevel(2)">Level 2</span> | <span onclick="goToLevel(3)">Level 3</span>
</p>
<br><br><br><br><br><br>
<div id="precent"></div>
<div id="display">
<p><span id="line0" class="top"></span></p>
<p><span id="line1" class="btwn"></span></p>
<p><span id="line2" class="btwn"></span></p>
<p><span id="line3" class="btwn"></span></p>
<p><span id="line4" class="btwn"></span></p>
<p><span id="line5" class="btwn"></span></p>
<p><span id="line6" class="btwn"></span></p>
<p><span id="line7" class="btwn"></span></p>
<p><span id="line8" class="btwn"></span></p>
<p><span id="line9" class="btwn"></span></p>
<p><span id="line10" class="bottom"></span></p>
</div>
<script>
var maps = [
	[],[
	"........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................",
	"........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................",
	"........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................",
	".......................................(Z.are.also.blocks)..............................................................................................................................................................................................................................................................................................................................................................................................................................................",
	"...................................................................................................................................................................................................................................A.....................................................................................................................................##########............#####################################............................Q....Q....Q.............................",
	"................................Hi!.#.are.blocks,as.you.can.see......................A is a spike............................................................................................###########.....#####.....#############.....................................................................................................................................VVVVVVVVVV...............................V..........=.VVVVV.......................Q............................................",
	".............................................................................................................................................................................................############A.............#############........................Q.is.a.jump.orb,.try.clicking.it!.....................................Jump pads!............................................................................................................................................................",
	".................................................................................................................................................................................##########################A...........#############.........................................................................Q.....................................................................................................................................#####................................................",
	"..........................................................................................A...........................A................A..................AA.....................###########################AAAAAAAAAAA#############AAAAA.........................................................................................................-.............-............-.................=..........AAAAAAAAAAAAAAAA.........................#####AAAAAAAAAAAAAAAAAAAAAAA.........................",
	"##########################################################################################################################################################################################################################################################################################################AAAAAAA#######################################################################################################################################################################################",
	"########################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################"],
	[
	".....................................................................................................................................#.........................#..............................................................#..............................................#........................D....................................................................#.................................................................................................................................#...................................................................................................................................................................................................................................................................................................................................",
	".....................................................................................................................................#.........................#............................................Gravity orb.......#..............................................#........................D...Wave.normally.dies.on.blocks,.it.can.only.survive.on.D.blocks...#....................................................................AAAA..........................................................#...................................................................................................................................................................................................................................................................................................................................",
	".....................................................................................................................................#.........................#.........Don't.fall.off!......................................#..............................................#........................D..................................................................#.........AAAA........................................................VVVV..........................AAAA............................#................................Speed.change.......................................................................................................................................................................................................................................................................................",
	".....................................................................................................................................###########################.................................................@............#..............................................#.....Wave!...........>..DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDVVVVVVVVVVVVVVVVVVVVVV..........VVVV................AAAA..............AAAA................................................VVVV...................AAAA.....#...................................................................................................................................................................................................................................................................................................................................",
	".....................................................................................................................................#........................................................................................################################################..............................................###########..........#.....................................................VVVV..............VVVV.......................................................................VVVV.....#...................................................................................................................................................................................................................................................................................................................................",
	"...................................Welcome to level 2...........................A....................................................#..............................................................................................VV......VV......VV.............#........................-.........................##.....###...###......#........................................................................................................................AAAA.....................................X....................................2.............................................................................................................................................................................................................................................................................................",
	"............................................................................Q...#..........................................Ball!.....V......................##################...................................A..............AA......AA......AA......AA.........#.......................##........................####.....#.....#......###............................#....................................................................AAAA..................VVVV.....................................X...........................................................................................................................3......................................................4....................WOOOOAAAAHHHHHHHH!!!!!!!........................0..........................................................................",
	"................................................................................#...........................................................................#................#..Q....Q....Q....Q...#######################################################..........X................-..............................######................#####................................................................................................VVVV...........................................................X....................................A......................................................................................3......................................................4....................................................................0..........................................................................",
	".........................AA...............AA.............AA.............-.......#.....................AAA............................O......................#................#.....................#.....................................................#........####################.............................########......#.......#######...........................................AAAA...............................AAAA...........................................................................DDDD###################################........................AA......................................AA....................3..............A....................A..................4....................................................................0...................AAA....................................................",
	"#############################################################################################################################################################................#.....................#.....................................................#........#..........#########################DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDAAAAAAAAAAAAAAAAAAAAAA..................VVVV...............................VVVV......................................................AAAA.................####################################################################################################################################################################################################################################################################################################################################",
	"#############################################################################################################################################################................#.....................#.....................................................#........#..........#############################################################################################..............................................................................................................VVVV.................####################################################################################################################################################################################################################################################################################################################################"],
	[
	".......................................................................................................................................................................................................................######################################====#####....................#####################################################################................#...........#...........#......................................................................................#...............#........................................................................................",
	"..........................................................................................................................................................................................................................................V.......V.....X.................................#####################################################################................#...........#...........#......................................................................................#...............#........................................................................................",
	".............................................................................................................................................................................................................................3O......A........A.........X...............4>................#####################################################################................#...........#...........#......................................................................................#################........................................................................................",
	"...............................................................................................................................................................................................................QQQQQQ..###############################################..4>.....................................................................................................#...........#...........#......................................................................................VVVVVVVVVVVVVVVVV........................................................................................",
	"...............................Demon?.........................................................................................................................................................................QQQQQQQ..#.............................................#...>...............................................................................................#.....#.....#.....#.....#.....#...............................................................................................................................................................................................",
	".............................................................................................................................................................................................................Q.........#.............................................#...................................................................................................#.....#.....#.....#.....#.....#.......................................................................1.................@...@....@..@.........................Unbelieveable...................................................",
	".................................2........................................................................................0...................................1................Q............Q...............Q..........#.............................................#...................................................................................................#.....#.....#.....#.....#.....#.......................................................................1..............@@@@@@@@@@@@@@@@@........................................................................................",
	".................................2........................................................................................0...................................1............................................Q...........#.............................................#....................######################################################################.........#...........#...........#.......X.............AA....................................AA................1..............@...@..@..@..@..@........................................................................................",
	".................................2...........AAA.......AAA........AAA.......AAA.........AAA..........AAA.......AAA........0.........AAAA..........AAAA........1..............AAAAA........AAAAA........................#.............................................#....................######################################################################.........#...........#...........#DDDDDDDD######################################################################.......................................................................................................................",
	"########################################################################################################################################################################################################################.............................................###########################################################################################.........#...........#...........#..........................................................................##################AAAAAAAAAAAAAAAAA########################################################################################",
	"########################################################################################################################################################################################################################.............................................###########################################################################################.........#...........#...........#..........................................................................###########################################################################################################################"]]; //0 reserved for custom if i can manage to add it (for now just modify the array in code, it's arranged the same way as the level)

/*                 -- OBJECT LIST --

.: empty            #,Z: block/floor  A,V: spike          M,W: ground spikes
D: d block (wave can slide on it, affects neighbors)      H: h block (cube can hit head and not die)
-: yellow pad       =: blue pad
Q: yellow orb       @: blue orb
X,>,O: gamemode changes (same as icon)  0,1,2,3,4: speed changes
): normal gravity   [: reverse gravity
All others: decoration (has no collision or special effect)
*/
var solid = ["#", "H", "Z", "D", "H"];
var deadly = ["A", "V", "M", "W"];
var tickrates = [100, 66, 40, 30, 16]; //ms per frame on diffferent speeds (speed chamge works like speedhack here)
var speed = 1;
var icons = ["X", ">", "O"]; //icons for different gamemodes (0=cube, 1=wave, 2=ball)
var mode = 0; //refer to previous for explanation
var gravity = 1;
var waveSpd = 1;
var held = false;
var bufferCheck = true;
var level = 1;
var posX = 7;
var posY = 8;
//gravity sucks here, when you jump you go up, hover, then go down.
var jumpFrames = 0; //this tracks how many frames you will go up for
var hoverFrames = 0; //this tracks how many frames you will hover for
function goToLevel(n){
	level = n;
	posX = 7;
	posY = 7;
	mode = 0;
	gravity = 1;
	speed = 1;
	held = false;
	bufferCheck = true;
	bufferNext = false;
}
function levelLength(){
	return maps[level][0].length - 25;
}
function drawLevel(){
	for (i = 0; i < 11; i++){
		document.getElementById("line" + i).innerHTML = maps[level][i].substring(posX - 4, posX + 18).replaceAll(".", "&nbsp;");
	}
	//we cut the player into the correct line
	var playerslice = maps[level][posY].substring(posX - 4, posX + 18);
	document.getElementById("line" + posY).innerHTML = (playerslice.slice(0,4) + icons[mode] + playerslice.slice(5)).replaceAll(".", "&nbsp;");
}
function blockAt(x, y){
	if(y == -1){y = 0}
	if(y == 11){y = 10}
	return maps[level][y][x];
}
function blockNe(){
	return [blockAt(posX-1,posY-1),blockAt(posX-1,posY),blockAt(posX-1,posY+1),blockAt(posX,posY-1),blockAt(posX,posY),blockAt(posX,posY+1),blockAt(posX+1,posY-1),blockAt(posX+1,posY),blockAt(posX+1,posY+1)];
	//returns player block and neighbors as an array
}
// game loop
function step(){
	var dy = gravity;
	//handle jumping
	if(held){
		switch (mode){
		case 0:
			if(solid.includes(blockAt(posX, posY + gravity))){
				jumpFrames = 2;
				hoverFrames = 1;
			}
			break;
		case 1:
			waveSpd = -1;
			break;
		case 2:
			if(solid.includes(blockAt(posX, posY + gravity))){
				gravity = gravity * -1;
			}
			break;
		}
		if(blockNe().includes("Q") && mode != 1 && bufferCheck){
			jumpFrames = 2;
			hoverFrames = 1;
			bufferCheck = false;
		}
		if(blockNe().includes("@") && bufferCheck){
			gravity = gravity * -1;
			jumpFrames = 0;
			hoverFrames = 0;
			bufferCheck = false;
		}
	}
	//handle special blocks
	if(blockAt(posX, posY) == "-" && mode != 1){
		jumpFrames = 3;
		hoverFrames = 2;
	}
	if(blockAt(posX, posY) == "="){
		gravity = gravity * -1;
		dy = dy * -1;
	}
	if(blockNe().includes(")")){
		gravity = 1;
		dy = 1;
		hoverFrames = 1;
	}
	if(blockNe().includes("[")){
		gravity = -1;
		dy = -1;
		hoverFrames = 1;
	}
	if(blockNe().includes("0")){
		speed = 0;
	}
	if(blockNe().includes("1")){
		speed = 1;
	}
	if(blockNe().includes("2")){
		speed = 2;
	}
	if(blockNe().includes("3")){
		speed = 3;
	}
	if(blockNe().includes("4")){
		speed = 4;
	}	
	if(blockNe().includes("X")){
		mode = 0;
	}	
	if(blockNe().includes(">")){
		mode = 1;
		jumpFrames = 0;
		hoverFrames = 0;
	}	
	if(blockNe().includes("O")){
		mode = 2;
	}
	if(jumpFrames > 0){
	dy = gravity*-1;
	jumpFrames--;
	}
	else if (hoverFrames > 0){
	dy = 0;
	hoverFrames--;
	}
	if(mode == 1){
		dy = gravity * waveSpd;
	}
	//collision checks
	//check if we hit our head (if we did we die)
	if(solid.includes(blockAt(posX+1, posY+dy)) && dy == gravity * -1 && (mode == 2 || (mode == 0 && blockNe().includes("H")) || (mode == 1 && blockNe().includes("D")))){
		dy = 0;
		hoverFrames = 0;
	}
	if(dy == gravity * -1 && solid.includes(blockAt(posX+1,posY+dy)) && mode != 2 && !(mode == 1 && blockNe().includes("D"))){
		goToLevel(level);
	}
	//if a block is below, do not fall
	if(solid.includes(blockAt(posX+1, posY+dy)) && dy == gravity){
		dy = 0;
		if(mode == 1 && !blockNe().includes("D")){
			goToLevel(level);
		}
	}
	if(solid.includes(blockAt(posX+1, posY+dy)) && mode == 1 && waveSpd == -1 && blockNe().includes("D")){
		dy = 0;
	}
	//if you hit something, die
	if(solid.includes(blockAt(posX+1, posY+dy)) || deadly.includes(blockAt(posX+1, posY+dy))){
		goToLevel(level);
	}
	if(posY+dy > 10 || posY+dy < 0){
		goToLevel(level);
	}
	drawLevel();
	if(posX <= levelLength()){
	posX = posX + 1;
	}
	posY = posY + dy
	document.getElementById("precent").textContent = Math.floor(100*(posX/levelLength())) + "%";
	if(posX >= levelLength()){
	document.getElementById("precent").textContent = "Level complete!";
	}
	setTimeout(step, tickrates[speed]);
	
}
//actually calling the game loop
step()
document.addEventListener("keydown", function(){held = true;})
document.addEventListener("keyup", function(){waveSpd = 1; held = false; bufferCheck = true;})
</script>
</body>
</html>